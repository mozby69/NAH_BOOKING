<!DOCTYPE html>
<html>
<head>
    <title>Print Weekly Events</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            font-size:.7rem;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        @media print {
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="main-container" style="margin:1rem 2rem;">
        <div class="weekname" style="margin-right: 3rem;display:flex;justify-content:space-between">
            <div><h4>Nazareth Weekly Schedule</h4></div>
            <div><h4 id="weekRange">{{ week_start_display }} - {{ week_end_display }}</h4></div>
            <div><h4>Category: {{ selected_category|default:"All Categories" }}</h4></div>
        </div>

        <table class="table table-bordered table-hover table-striped tables">
            <thead>
                <tr>
                    <th></th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Category</th>
                    <th>Client Name</th>
                </tr>
            </thead>
            <tbody>
                {% for day, events in grouped_events.items %}
                    {% if events %}
                        {% for event in events %}
                            <tr>
                                {% if forloop.first %}
                                    <th rowspan="{{ events|length }}">{{ day }}</th>
                                {% endif %}
                                <td>{{ event.date_start }}</td>
                                <td>{{ event.date_end }}</td>
                                <td>{{ event.start_time }}</td>
                                <td>{{ event.end_time }}</td>
                                <td>{{ event.category }}</td>
                                <td>{{ event.name }}</td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="7"></td>
                        </tr>
                    {% else %}
                        <tr>
                            <th>{{ day }}</th>
                            <td colspan="6">No events</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>

        <div class="no-print" style="float:right;">
            <button onclick="window.print()" style="padding:.6rem 1.6rem;margin-top:.8rem;margin-bottom:2rem;background-color:green;color:white;border:none;border-radius:.5rem;font-weight:bold;">Print</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const weekStart = new Date("{{ week_start|date:'F j, Y' }}");
            const weekEnd = new Date("{{ week_end|date:'F j, Y' }}");
            const weekRangeText = formatWeekRange(weekStart, weekEnd);
            document.getElementById('weekRange').textContent = weekRangeText;
        
            // Retrieve the category from the data attribute
            const categoryHolder = document.getElementById('categoryHolder');
            if (categoryHolder) {
                const selectedCategory = categoryHolder.getAttribute('data-category');
                document.getElementById('categoryDisplay').textContent = selectedCategory || 'All Categories';
            }
        });
        
        function formatWeekRange(startDate, endDate) {
            const startMonth = startDate.toLocaleString('default', { month: 'long' });
            const endMonth = endDate.toLocaleString('default', { month: 'long' });
            const startDay = startDate.getDate();
            const endDay = endDate.getDate();
            return `${startMonth} ${startDay} - ${endMonth} ${endDay}`;
        }

    </script>
    



</body>
</html>
